<?php session_start();
if (!isset($_SESSION['loggedin'])) {
	header("Location: login.php");
	exit;
} else {
	// the session variable exists, let's check it's valid:
	require_once('settings.php');
	$userexists = false;

	foreach($users as $username => $password) {
		if (md5($username.$password.$salt) == $_SESSION['loggedin'])
			$userexists = true;
	}

	if ($userexists !== true) {
		exit('<p>Invalid session: please <a href="login.php">login</a>.</p>');
	}
}
?>